{% extends "base.html" %}

{% block title %}Carga de Datos{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold text-center mb-4">Cargar Datos</h1>

<!-- Barra de progreso -->
<div class="w-full bg-gray-200 rounded-full h-2.5 mb-4 hidden">
    <div class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
</div>

<!-- Formulario Manual -->
<div class="bg-white p-6 rounded-lg shadow-md mb-6">
    <h2 class="text-2xl font-semibold mb-4">Ingreso Manual</h2>
    <form id="manualForm" action="/generar" method="POST" class="space-y-4">
        <input type="text" name="nombres" placeholder="Nombres" required class="w-full p-2 border border-gray-300 rounded-lg">
        <div>
            <input type="text" name="cedula" placeholder="Cédula" required class="w-full p-2 border border-gray-300 rounded-lg">
            <div class="text-red-500 text-sm mt-1 hidden" id="cedulaError">Formato inválido. Ejemplo: 1234567</div>
        </div>
        <input type="text" name="grupo" placeholder="Grupo" required class="w-full p-2 border border-gray-300 rounded-lg">
        <input type="text" name="distrito" placeholder="Distrito" required class="w-full p-2 border border-gray-300 rounded-lg">
        <input type="text" name="region" placeholder="Región" required class="w-full p-2 border border-gray-300 rounded-lg">
        <button type="submit" class="w-full bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600">Generar Reconocimiento</button>
    </form>
</div>

<!-- Subida de CSV con tooltip -->
<div class="bg-white p-6 rounded-lg shadow-md">
    <h2 class="text-2xl font-semibold mb-4">Subir CSV
        <span class="relative group">
            <span class="ml-2 text-gray-400 cursor-help">(?)</span>
            <span class="absolute bottom-full mb-2 w-64 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity">
                Formato requerido: nombres,cedula,grupo,distrito,region<br>
                Ejemplo: "Juan Pérez",1-2345-6789,Grupo A,Distrito Norte,Región Central
            </span>
        </span>
    </h2>
    <form action="/cargar-csv" method="POST" enctype="multipart/form-data" class="space-y-4">
        <input type="file" name="csv" accept=".csv" required class="w-full p-2 border border-gray-300 rounded-lg">
        <button type="submit" class="w-full bg-green-500 text-white p-2 rounded-lg hover:bg-green-600">Subir CSV</button>
    </form>
</div>

<script>
    // Simulación de barra de progreso para TODOS los formularios
    document.querySelectorAll('form').forEach(form => {
        form.addEventListener('submit', function() {
            const progressBar = document.querySelector('.progress-bar');
            const progressFill = document.querySelector('.progress-fill');
            
            progressBar.classList.remove('hidden');
            let width = 0;
            const interval = setInterval(() => {
                if (width >= 100) {
                    clearInterval(interval);
                } else {
                    width += 10;
                    progressFill.style.width = width + '%';
                }
            }, 300);
        });
    });
</script>
{% endblock %}